<div class="crafting-view-container">
  <!-- Craft Result Notification -->
  <div class="craft-result-notification" *ngIf="lastCraftResult">
    <div class="notification-card" [class.success]="lastCraftResult.success" [class.failure]="!lastCraftResult.success">
      <div class="notification-header">
        <span class="notification-icon" [class.success-icon]="lastCraftResult.success" [class.error-icon]="!lastCraftResult.success">
          {{ lastCraftResult.success ? 'âœ“' : 'âœ•' }}
        </span>
        <h3 class="notification-title">{{ lastCraftResult.success ? 'Crafting Successful!' : 'Crafting Failed' }}</h3>
      </div>
      <div class="notification-content">
        <p>{{ lastCraftResult.message }}</p>
        <div *ngIf="lastCraftResult.success && lastCraftResult.itemId" class="result-details">
          <strong>Created:</strong> {{ lastCraftResult.quantity }}x {{ formatItemName(lastCraftResult.itemId) }}
        </div>
      </div>
      <div class="notification-actions">
        <button class="btn btn-text" (click)="dismissResult()">
          <span class="btn-icon">âœ•</span>
          Dismiss
        </button>
      </div>
    </div>
  </div>

  <!-- Category Tabs -->
  <div class="category-tabs-card">
    <div class="category-chips">
      <button class="chip" [class.selected]="selectedCategory === 'all'" (click)="selectCategory('all')">
        <span class="chip-icon">âŠ</span>
        All ({{ availableRecipes.length }})
      </button>
      <button class="chip" [class.selected]="selectedCategory === 'weapon'" (click)="selectCategory('weapon')">
        <span class="chip-icon">âš”</span>
        Weapons ({{ getCategoryCount('weapon') }})
      </button>
      <button class="chip" [class.selected]="selectedCategory === 'armor'" (click)="selectCategory('armor')">
        <span class="chip-icon">ğŸ›¡</span>
        Armor ({{ getCategoryCount('armor') }})
      </button>
      <button class="chip" [class.selected]="selectedCategory === 'fabrial'" (click)="selectCategory('fabrial')">
        <span class="chip-icon">âœ¦</span>
        Fabrials ({{ getCategoryCount('fabrial') }})
      </button>
      <button class="chip" [class.selected]="selectedCategory === 'consumable'" (click)="selectCategory('consumable')">
        <span class="chip-icon">âš—</span>
        Consumables ({{ getCategoryCount('consumable') }})
      </button>
      <button class="chip" [class.selected]="selectedCategory === 'equipment'" (click)="selectCategory('equipment')">
        <span class="chip-icon">ğŸ”§</span>
        Equipment ({{ getCategoryCount('equipment') }})
      </button>
    </div>
  </div>

  <!-- Recipe List -->
  <div class="recipes-list">
    <div class="recipe-accordion">
      <details class="recipe-panel" *ngFor="let recipe of getFilteredRecipes()">
        <summary class="recipe-header">
          <div class="recipe-title">
            <span class="recipe-icon">{{ getCategoryIcon(recipe.category) }}</span>
            <span class="recipe-name">{{ recipe.name }}</span>
          </div>
          <div class="recipe-description-inline">
            <span class="difficulty-chip difficulty-{{ recipe.difficulty }}">
              {{ formatDifficulty(recipe.difficulty) }}
            </span>
          </div>
        </summary>

        <div class="recipe-details">
          <!-- Description -->
          <div class="recipe-section">
            <p class="recipe-description">{{ recipe.description }}</p>
          </div>

          <!-- Required Expertise -->
          <div class="recipe-section">
            <h4>
              <span class="section-icon">ğŸ“</span>
              Required Expertise
            </h4>
            <span class="expertise-chip">{{ recipe.requiredExpertise }}</span>
          </div>

          <!-- Materials -->
          <div class="recipe-section">
            <h4>
              <span class="section-icon">ğŸ“¦</span>
              Required Materials
            </h4>
            <div class="materials-list">
              <div *ngFor="let material of recipe.materials" 
                   class="material-item"
                   [class.has-material]="hasMaterial(material)"
                   [class.lacks-material]="!hasMaterial(material)">
                <span class="material-icon">
                  {{ hasMaterial(material) ? 'âœ“' : 'âœ•' }}
                </span>
                <span class="material-name">{{ formatItemName(material.itemId) }}</span>
                <span class="material-quantity">
                  {{ getItemQuantity(material.itemId) }} / {{ material.quantity }}
                </span>
              </div>
            </div>
          </div>

          <!-- Result -->
          <div class="recipe-section">
            <h4>
              <span class="section-icon">ğŸ†</span>
              Result
            </h4>
            <div class="result-item">
              <span>{{ recipe.resultQuantity }}x {{ formatItemName(recipe.resultItemId) }}</span>
              <span *ngIf="recipe.craftingTime" class="crafting-time">
                <span class="time-icon">â±</span>
                {{ recipe.craftingTime }}
              </span>
            </div>
          </div>

          <!-- Craft Button -->
          <div class="craft-action">
            <button class="btn btn-primary craft-button"
                    [disabled]="!canCraftRecipe(recipe.id)"
                    (click)="craftItem(recipe)">
              <span class="btn-icon">ğŸ”¨</span>
              {{ canCraftRecipe(recipe.id) ? 'Craft Item' : getCraftabilityMessage(recipe.id) }}
            </button>
          </div>
        </div>
      </details>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="getFilteredRecipes().length === 0">
      <span class="empty-icon">â„¹</span>
      <h3>No Recipes Available</h3>
      <p *ngIf="availableRecipes.length === 0">
        You need crafting expertises to unlock recipes.
        Gain expertises through your culture, talents, or from the GM.
      </p>
      <p *ngIf="availableRecipes.length > 0">
        No recipes in this category. Try selecting a different category.
      </p>
    </div>
  </div>
</div>
