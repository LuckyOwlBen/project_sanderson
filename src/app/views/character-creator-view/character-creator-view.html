<div class="character-creator-container">
    <div class="creator-main">

        <!-- The router-outlet will render the child component here -->
        <router-outlet></router-outlet>

        <div class="stepper-buttons">
            <button mat-button (click)="previousStep()" [disabled]="!canGoPrevious()">
                Back
            </button>
            <button mat-raised-button color="primary" (click)="nextStep()" [disabled]="!canGoNext()">
                Next
            </button>
        </div>
    </div>

    <!-- Floating character preview (hidden until skills page) -->
    <div class="character-preview" *ngIf="currentStep >= 4">
        <mat-card>
            <mat-card-header>
                <mat-card-title>Character Preview</mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <div *ngIf="characterState.character$ | async as character" class="preview-content">
                    <!-- Basic Info -->
                    <div class="preview-section">
                        <h3>Basic Info</h3>
                        <p><strong>Name:</strong> {{ character.name || 'Unnamed' }}</p>
                        <p><strong>Level:</strong> {{ character.level }}</p>
                        <p><strong>Ancestry:</strong> {{ character.ancestry || 'Not selected' }}</p>
                    </div>

                    <!-- Cultures -->
                    <div class="preview-section" *ngIf="character.cultures.length > 0">
                        <h3>Cultures</h3>
                        <p *ngFor="let culture of character.cultures">• {{ culture.name }}</p>
                    </div>

                    <!-- Paths -->
                    <div class="preview-section" *ngIf="character.paths.length > 0">
                        <h3>Path</h3>
                        <p *ngFor="let path of character.paths">• {{ path }}</p>
                    </div>

                    <!-- Attributes -->
                    <div class="preview-section">
                        <h3>Attributes</h3>
                        <div class="attributes-grid">
                            <div class="attribute-item">
                                <span class="attr-label">Strength:</span>
                                <span class="attr-value">{{ character.attributes.strength }}</span>
                            </div>
                            <div class="attribute-item">
                                <span class="attr-label">Speed:</span>
                                <span class="attr-value">{{ character.attributes.speed }}</span>
                            </div>
                            <div class="attribute-item">
                                <span class="attr-label">Intellect:</span>
                                <span class="attr-value">{{ character.attributes.intellect }}</span>
                            </div>
                            <div class="attribute-item">
                                <span class="attr-label">Willpower:</span>
                                <span class="attr-value">{{ character.attributes.willpower }}</span>
                            </div>
                            <div class="attribute-item">
                                <span class="attr-label">Awareness:</span>
                                <span class="attr-value">{{ character.attributes.awareness }}</span>
                            </div>
                            <div class="attribute-item">
                                <span class="attr-label">Presence:</span>
                                <span class="attr-value">{{ character.attributes.presence }}</span>
                            </div>
                        </div>
                    </div>

                    <!-- Skills -->
                    <div class="preview-section">
                        <h3>Skills (Trained)</h3>
                        <div class="skills-list">
                            <p *ngFor="let skill of getTrainedSkills(character)" class="skill-item">
                                {{ skill.name }}: {{ skill.rank }}
                            </p>
                            <p *ngIf="getTrainedSkills(character).length === 0" class="empty-text">No skills trained yet</p>
                        </div>
                    </div>

                    <!-- Talents -->
                    <div class="preview-section" *ngIf="character.unlockedTalents.size > 0">
                        <h3>Talents</h3>
                        <div class="talents-list">
                            <p *ngFor="let talentId of getTalentIds(character)" class="talent-item">
                                • {{ talentId }}
                            </p>
                        </div>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>
    </div>
</div>
